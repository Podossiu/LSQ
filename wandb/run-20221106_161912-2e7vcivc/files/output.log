INFO - Log file for this run: /home/ilena7440/slsq/LSQ/out/MobileNetv2_imagenet_a8w8_30_epoch80_20221106-161913/MobileNetv2_imagenet_a8w8_30_epoch80_20221106-161913.log
2022-11-06 16:19:13.474365: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-11-06 16:19:13.596706: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2022-11-06 16:19:13.977433: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2022-11-06 16:19:13.977480: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2022-11-06 16:19:13.977485: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
INFO - TensorBoard data directory: /home/ilena7440/slsq/LSQ/out/MobileNetv2_imagenet_a8w8_30_epoch80_20221106-161913/tb_runs
********************pre-trained*****************
/home/ilena7440/qilbertenv/lib/python3.8/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 32 worker processes in total. Our suggested max number of worker in current system is 16, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
INFO - Dataset `imagenet` size:
          Training Set = 1281167 (10010)
        Validation Set = 50000 (391)
              Test Set = 50000 (391)
INFO - Created `MobileNetv2` model for `imagenet` dataset
          Use pre-trained model = True
INFO - Validation: 50000 samples (128 per mini-batch)
INFO - Validation [   20/  391]   Loss 0.769919   Top1 80.273438   Top5 94.804688   BatchTime 0.485786
INFO - Validation [   40/  391]   Loss 0.815652   Top1 79.003906   Top5 94.375000   BatchTime 0.277386
INFO - Validation [   60/  391]   Loss 0.776288   Top1 80.234375   Top5 94.375000   BatchTime 0.208489
INFO - Validation [   80/  391]   Loss 0.829731   Top1 78.544922   Top5 94.199219   BatchTime 0.174103
INFO - Validation [  100/  391]   Loss 0.827339   Top1 78.359375   Top5 94.406250   BatchTime 0.153542
INFO - Validation [  120/  391]   Loss 0.828905   Top1 78.203125   Top5 94.537760   BatchTime 0.140239
INFO - Validation [  140/  391]   Loss 0.816660   Top1 78.521205   Top5 94.637277   BatchTime 0.130217
INFO - Validation [  160/  391]   Loss 0.832974   Top1 78.251953   Top5 94.399414   BatchTime 0.122578
INFO - Validation [  180/  391]   Loss 0.886754   Top1 77.092014   Top5 93.745660   BatchTime 0.116831
INFO - Validation [  200/  391]   Loss 0.955149   Top1 75.679688   Top5 92.902344   BatchTime 0.112230
INFO - Validation [  220/  391]   Loss 0.985625   Top1 75.117188   Top5 92.492898   BatchTime 0.108405
INFO - Validation [  240/  391]   Loss 1.004075   Top1 74.863281   Top5 92.158203   BatchTime 0.105265
INFO - Validation [  260/  391]   Loss 1.046878   Top1 73.867188   Top5 91.634615   BatchTime 0.102592
INFO - Validation [  280/  391]   Loss 1.065488   Top1 73.574219   Top5 91.442522   BatchTime 0.100207
INFO - Validation [  300/  391]   Loss 1.088454   Top1 73.114583   Top5 91.098958   BatchTime 0.098140
INFO - Validation [  320/  391]   Loss 1.109445   Top1 72.714844   Top5 90.810547   BatchTime 0.096383
INFO - Validation [  340/  391]   Loss 1.131319   Top1 72.231158   Top5 90.523897   BatchTime 0.094770
INFO - Validation [  360/  391]   Loss 1.145701   Top1 71.911892   Top5 90.362413   BatchTime 0.093165
INFO - Validation [  380/  391]   Loss 1.142867   Top1 71.924342   Top5 90.407072   BatchTime 0.091729
INFO - ==> Top1: 72.050    Top5: 90.482    Loss: 1.137
Traceback (most recent call last):
  File "main.py", line 177, in <module>
    main()
  File "main.py", line 77, in main
    top1, top5, _,sparsity = process.validate(val_loader, model, criterion,
  File "/home/ilena7440/slsq/LSQ/process.py", line 147, in validate
    sparsity = total_zero / total_numel
ZeroDivisionError: float division by zero